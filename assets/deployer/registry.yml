version: 0.1
log:
  formatter: json
storage:
  # cache:
  #   blobdescriptor: redis
  # dev
  filesystem:
    rootdirectory: /data
  # prod
  # s3:
  #   accesskey:
  #   secretkey:
  #   region:
  #   regionendpoint:
  #   bucket:
  #   encrypt:
  #   keyid:
  #   secure: true
  #   v4auth:
  #   chunksize:
  #   multipartcopychunksize:
  #   multipartcopymaxconcurrency:
  #   multipartcopythresholdsize:
  #   rootdirectory:
http:
  addr: :5000
  headers:
    X-Content-Type-Options: [nosniff]
auth:
  token:
    realm: http://localhost:3000/auth/docker-registry-token
    service: Docker registry
    issuer: localhost:3000
    rootcertbundle: /certs/ecdsa.pubkey.crt
#
# TLS will be handled through reverse proxy
#http:
#    tls:
#        certificate: /certs/server.crt
#        key: /certs/server.key
# health:
#   storagedriver:
#     enabled: true
#     interval: 10s
#     threshold: 3
notifications:
  endpoints:
    - name: bytesonus
      url: http://localhost:3000/docker-registry/notification
      timeout: 30m
      threshold: 5
      backoff: 1m
      ignore:
        actions:
          - pull

# HTTP/1.1 401 Unauthorized
# Content-Type: application/json
# Docker-Distribution-Api-Version: registry/2.0
# Www-Authenticate: Bearer realm="http://localhost:3000/token",service="Docker registry",scope="repository:test/test:pull"

# {"errors":[{"code":"UNAUTHORIZED","message":"access to the requested resource is not authorized","detail":[{"Type":"repository","Name":"samalba/my-app","Action":"pull"},{"Type":"repository","Name":"samalba/my-app","Action":"push"}]}]}

# HTTP/1.1 200 OK
# Content-Type: application/json

# {"token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiIsImtpZCI6IkpZRk86QVRNSTpINFJJOk5DN0k6Sk1RSDo3U1Q1OlJVWFM6NEJJRzpDQktMOkJFM0I6RlNOVDpWWU42In0.eyJpc3MiOiJsb2NhbGhvc3Q6MzAwMCIsInN1YiI6InRlc3QiLCJhdWQiOiJEb2NrZXIgcmVnaXN0cnkiLCJleHAiOjE2NDU4NzQ1Nzc3NTIsIm5iZiI6MTYxNDMzODU3Nzc1MiwiaWF0IjoxNjE0MzM4NTc3NzUyLCJqdGkiOiJub3BlbG9seiIsImFjY2VzcyI6W3sidHlwZSI6InJlcG9zaXRvcnkiLCJuYW1lIjoidGVzdC90ZXN0IiwiYWN0aW9ucyI6WyJwdWxsIl19XX0.pb5yPApcKZqp2tC0KbgXvH8tGU4I1aiBs4QmSkZpF_H900McBES3fHnwDQUzxeAR0HCTH5MRrAyDPir6R7fZFA"}
